(window.webpackJsonp=window.webpackJsonp||[]).push([[41,21,23],{670:function(e,t,n){"use strict";n.r(t);var r=n(638),o=n(230),c=n(101),l=n(651),d=n(639),m=n(225),f={props:{method:{type:Function,default:null},open:{required:!0},message:{type:String}},watch:{open:function(e){e?document.addEventListener("keydown",this.handleKeydown):document.removeEventListener("keydown",this.handleKeydown)}},data:function(){return{}},methods:{confirm:function(){null===this.method||this.method(),this.$emit("update:complete",!1)},handleKeydown:function(e){"Escape"===e.key&&this.confirm()}}},h=n(64),component=Object(h.a)(f,(function(){var e=this,t=e._self._c;return t(l.a,{attrs:{persistent:"","retain-focus":!1,"max-width":"300","max-height":"300","content-class":"rounded-xl"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.confirm.apply(null,arguments)}},model:{value:e.open,callback:function(t){e.open=t},expression:"open"}},[t(o.a,[t(c.d,{staticClass:"d-flex align-center justify-center text-h6"},[t(m.a,{staticClass:"mr-3",attrs:{color:"#24b224",size:"40"}},[e._v("mdi-check-circle")]),e._v("\n      สำเร็จ\n    ")],1),e._v(" "),t(d.a,{staticClass:"mb-3"}),e._v(" "),t(c.c,{staticClass:"text-center"},[e._v("\n      "+e._s(e.message)+"\n    ")]),e._v(" "),t(c.a,{staticClass:"justify-center"},[t(r.a,{staticClass:"rounded-xl font-weight-medium mt-0",attrs:{color:"#24b224"},on:{click:e.confirm}},[e._v("\n        ตกลง\n      ")])],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports},677:function(e,t,n){"use strict";n.r(t);var r=n(638),o=n(230),c=n(101),l=n(651),d=n(639),m=n(225),f={props:{method:{type:Function,default:null},open:{required:!0},message:{type:String}},watch:{open:function(e){e?document.addEventListener("keydown",this.handleKeydown):document.removeEventListener("keydown",this.handleKeydown)}},data:function(){return{}},methods:{confirm:function(){null===this.method||this.method(),this.$emit("update:error",!1)},handleKeydown:function(e){"Escape"===e.key&&this.confirm()}}},h=n(64),component=Object(h.a)(f,(function(){var e=this,t=e._self._c;return t(l.a,{attrs:{persistent:"","retain-focus":!1,"max-width":"300","max-height":"300","content-class":"rounded-xl"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.confirm.apply(null,arguments)}},model:{value:e.open,callback:function(t){e.open=t},expression:"open"}},[t(o.a,[t(c.d,{staticClass:"d-flex align-center justify-center text-h6"},[t(m.a,{staticClass:"mr-3",attrs:{size:"40",color:"#e50211"}},[e._v("mdi-alert")]),e._v("\n      เกิดข้อผิดพลาด\n    ")],1),e._v(" "),t(d.a,{staticClass:"mb-3"}),e._v(" "),t(c.c,{staticClass:"text-center"},[e._v("\n      "+e._s(e.message)+"\n    ")]),e._v(" "),t(c.a,{staticClass:"justify-center"},[t(r.a,{staticClass:"rounded-xl font-weight-medium mt-0",attrs:{color:"#24b224"},on:{click:e.confirm}},[e._v("\n        ตกลง\n      ")])],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports},749:function(e,t,n){"use strict";n.r(t);var r=n(638),o=n(230),c=n(101),l=n(921),d=n(651),m=n(225),f=n(4);n(16),n(14),n(92),n(80),n(38),n(19),n(20),n(12),n(6),n(15);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(f.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _={props:{open:Boolean,stocks:Array,sets:Array},data:function(){return{headers:[{text:"ชื่อหุ้น",value:"name"},{text:"ประเภท",value:"set_name"},{text:"จำนวนปันผล",value:"dividend_amount"},{text:"ราคาปิด",value:"closing_price"}]}},computed:{formattedStocks:function(){var e=this.sets||[];return this.stocks.map((function(t){var n=e.find((function(s){return s.id===t.set_id}));return v(v({},t),{},{set_name:n?n.name:""})}))}},methods:{confirm:function(){this.$emit("confirm")},cancel:function(){this.$emit("cancel")}}},k=n(64),component=Object(k.a)(_,(function(){var e=this,t=e._self._c;return t(d.a,{attrs:{"max-width":"500px"},model:{value:e.open,callback:function(t){e.open=t},expression:"open"}},[t(o.a,[t(c.d,{staticClass:"d-flex justify-center"},[t(m.a,{staticClass:"mr-3",attrs:{justify:"center",size:"40",color:"#24b224"}},[e._v("mdi-archive-check")]),e._v(" "),t("span",{staticClass:"headline"},[e._v("ตรวจสอบข้อมูลหุ้น")])],1),e._v(" "),t(c.c,[t(l.a,{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.formattedStocks,"hide-default-footer":""},scopedSlots:e._u([{key:"top",fn:function(){},proxy:!0}])})],1),e._v(" "),t(c.a,{staticClass:"d-flex justify-center"},[t(r.a,{staticClass:"mb-4",attrs:{color:"#24b224"},on:{click:e.confirm}},[e._v("ยืนยัน")]),e._v(" "),t(r.a,{staticClass:"ml-2 mb-4",attrs:{color:"#e50211"},on:{click:e.cancel}},[e._v("ยกเลิก")])],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports},781:function(e,t,n){var content=n(862);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(22).default)("3a9eb494",content,!0,{sourceMap:!1})},861:function(e,t,n){"use strict";n(781)},862:function(e,t,n){var r=n(21)((function(i){return i[1]}));r.push([e.i,".little-icon[data-v-668ac085]{font-size:3rem;margin-left:8px;margin-right:8px}.custom-card[data-v-668ac085]{margin:auto;max-width:800px;width:100%}",""]),r.locals={},e.exports=r},933:function(e,t,n){"use strict";n.r(t);var r=n(638),o=n(230),c=n(101),l=n(682),d=n(696),m=n(225),f=n(681),h=n(704),v=n(703),_=(n(38),n(31),n(2)),k=(n(14),n(92),n(16),n(74),n(75),n(65),n(94),n(80),n(192),n(61),n(6),n(43),n(47),n(60),n(71),n(34),n(1)),w=n.n(k);function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return x(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?x(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,c=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw c}}}}function x(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=Array(a);t<a;t++)n[t]=e[t];return n}w.a.locale("th");var C={layout:"user",middleware:"auth",mounted:function(){var e=this;return Object(_.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.checkRank();case 2:return t.next=4,e.fetchSetsData();case 4:case"end":return t.stop()}}),t)})))()},data:function(){return{modal:{complete:{open:!1,message:""},error:{open:!1,message:""}},valid:!1,showModalResult:!1,withdrawalItems:[{name:"",set_id:null,dividend_amount:null,closing_price:null}],sets:[]}},computed:{isFormValid:function(){var e=this;return this.withdrawalItems.every((function(t){return e.isNicknameValid(t.name)}))}},methods:{isFloatValid:function(e){return!!e&&/^[0-9]*\.?[0-9]+$/.test(e)},isNicknameValid:function(e){return null!==e&&""!==e},isFromValid:function(e){return null!==e&&""!==e},checkRank:function(){var e=this;return Object(_.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$auth.loggedIn){t.next=12;break}if(n=e.$auth.user.status.toString(),r=e.$auth.user.ranks_id.toString(),"2"!==n){t.next=9;break}return e.$router.push("/"),t.next=7,e.$auth.logout();case 7:t.next=10;break;case 9:"1"===r?e.$router.push("/app/stock/new_follow"):"2"===r?e.$router.push("/app/home"):"3"===r?e.$router.push("/app/stock/new_follow"):e.$router.push("/auth");case 10:t.next=13;break;case 12:e.$router.push("/");case 13:case"end":return t.stop()}}),t)})))()},openModal:function(){this.showModalResult=!0},confirmAndAddCustomers:function(){var e=this;return Object(_.a)(regeneratorRuntime.mark((function t(){var n,r,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((n=e.findDuplicateIds(e.withdrawalItems)).length>0)){t.next=5;break}return e.modal.error.message="มีหุ้นซ้ำ : ".concat(n.join(", ")),e.modal.error.open=!0,t.abrupt("return");case 5:r=y(e.withdrawalItems),t.prev=6,r.s();case 8:if((o=r.n()).done){t.next=24;break}return c=o.value,t.prev=10,t.next=13,e.$store.dispatch("api/stock/addStock",{name:c.name,set_id:c.set_id,dividend_amount:c.dividend_amount,closing_price:c.closing_price,emp_id:e.$auth.user.no,created_date:w()(new Date).format("YYYY-MM-DD HH:mm:ss"),updated_date:w()(new Date).format("YYYY-MM-DD HH:mm:ss")});case 13:t.next=22;break;case 15:if(t.prev=15,t.t0=t.catch(10),console.error("Error adding stock:",t.t0),!t.t0.response||400!==t.t0.response.status){t.next=22;break}return e.modal.error.message="มีชื่อหุ้นนี้ในระบบแล้ว : ".concat(c.name),e.modal.error.open=!0,t.abrupt("return");case 22:t.next=8;break;case 24:t.next=29;break;case 26:t.prev=26,t.t1=t.catch(6),r.e(t.t1);case 29:return t.prev=29,r.f(),t.finish(29);case 32:e.modal.complete.message="เพิ่มหุ้นเรียบร้อยแล้ว!",e.modal.complete.open=!0,e.recordLog(),e.showModalResult=!1;case 36:case"end":return t.stop()}}),t,null,[[6,26,29,32],[10,15]])})))()},findDuplicateIds:function(e){var t=e.map((function(e){return e.name}));return t.filter((function(e,n){return t.indexOf(e)!==n&&e}))},fetchSetsData:function(){var e=this;return Object(_.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("api/set/getSets");case 3:(n=t.sent)&&(e.sets=n.map((function(e){return{id:e.no,name:e.set}}))),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error fetching sets:",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},addProduct:function(){this.withdrawalItems.push({name:"",set_id:null,dividend_amount:null,closing_price:null})},removeProduct:function(e){this.withdrawalItems.splice(e,1)},goBack:function(){this.$router.push("/app/stock/management")},recordLog:function(){var e=this,details=this.withdrawalItems.map((function(t,n){var r,o=(null===(r=e.sets.find((function(e){return e.id===t.set_id})))||void 0===r?void 0:r.name)||"ยังไม่ระบุ";return"หุ้นที่ ".concat(n+1,"\n")+"ชื่อ : ".concat(t.name||"ยังไม่ระบุ","\n")+"ประเภท : ".concat(o,"\n")+"จำนวนปันผล : ".concat(t.dividend_amount||"ยังไม่ระบุ","\n")+"ราคาปิด : ".concat(t.closing_price||"ยังไม่ระบุ")})).join("\n\n"),t={emp_name:this.$auth.user.fname+" "+this.$auth.user.lname,emp_email:this.$auth.user.email,detail:details.trim(),type:2,picture:this.$auth.user.picture||"ไม่รู้จัก",action:"เพิ่มหุ้นใหม่",time:w()(new Date).format("YYYY-MM-DD HH:mm:ss")};this.$store.dispatch("api/log/addLogs",t)},goToStocksManagement:function(){this.$router.push("/app/stock/management")}}},$=(n(861),n(64)),component=Object($.a)(C,(function(){var e=this,t=e._self._c;return t("div",[t("ModalComplete",{attrs:{open:e.modal.complete.open,message:e.modal.complete.message,complete:e.modal.complete.open,method:e.goBack},on:{"update:complete":function(t){return e.$set(e.modal.complete,"open",t)}}}),e._v(" "),t("ModalError",{attrs:{open:e.modal.error.open,message:e.modal.error.message,error:e.modal.error.open},on:{"update:error":function(t){return e.$set(e.modal.error,"open",t)}}}),e._v(" "),t("ResultStock",{attrs:{open:e.showModalResult,stocks:e.withdrawalItems,sets:e.sets},on:{confirm:e.confirmAndAddCustomers,cancel:function(t){e.showModalResult=!1}}}),e._v(" "),t(o.a,{staticClass:"custom-card",attrs:{flat:""}},[t(c.d,{staticClass:"d-flex align-center justify-center"},[t(m.a,{staticClass:"little-icon",attrs:{color:"#24b224"}},[e._v("mdi-archive-plus")]),e._v("  \n            "),t("h3",{staticClass:"mb-0"},[e._v("การติดตามหุ้นใหม่")])],1),e._v(" "),t(c.c,[t(d.a,[e._l(e.withdrawalItems,(function(n,o){return t(f.a,{key:o,staticClass:"mb-0 mt-0 pa-0",attrs:{align:"center"}},[t(l.a,{staticClass:"ml-2",attrs:{cols:"3"}},[t(v.a,{attrs:{label:"ชื่อหุ้น",type:"text",dense:"",outlined:"",rules:[function(e){return!!e||"กรุณากรอกชื่อหุ้น"}]},model:{value:n.name,callback:function(t){e.$set(n,"name",t)},expression:"item.name"}})],1),e._v(" "),t(l.a,{attrs:{cols:"2"}},[t(h.a,{attrs:{items:e.sets,"item-text":"name","item-value":"id",label:"ประเภท",dense:"",outlined:""},model:{value:n.set_id,callback:function(t){e.$set(n,"set_id",t)},expression:"item.set_id"}})],1),e._v(" "),t(l.a,{attrs:{cols:"2"}},[t(v.a,{attrs:{label:"จำนวนปันผล",type:"text",dense:"",outlined:"",rules:[function(e){return!e||/^[0-9]*\.?[0-9]+$/.test(e)||"กรุณากรอกตัวเลข"}]},model:{value:n.dividend_amount,callback:function(t){e.$set(n,"dividend_amount",t)},expression:"item.dividend_amount"}})],1),e._v(" "),t(l.a,{attrs:{cols:"2"}},[t(v.a,{attrs:{label:"ราคาปิด",type:"text",dense:"",outlined:"",rules:[function(e){return!e||/^[0-9]*\.?[0-9]+$/.test(e)||"กรุณากรอกตัวเลข"}]},model:{value:n.closing_price,callback:function(t){e.$set(n,"closing_price",t)},expression:"item.closing_price"}})],1),e._v(" "),t(l.a,{staticClass:"d-flex align-center",attrs:{cols:"2"}},[t(r.a,{staticClass:"mb-6",attrs:{icon:"",color:"#e50211"},on:{click:function(t){return e.removeProduct(o)}}},[t(m.a,[e._v("mdi-delete")])],1),e._v(" "),t(r.a,{staticClass:"mb-6 ml-2",attrs:{color:"#24b224",text:""},on:{click:e.addProduct}},[t(m.a,{attrs:{left:""}},[e._v("mdi-archive-plus")]),e._v(" เพิ่ม\n                        ")],1)],1)],1)})),e._v(" "),t("div",{staticClass:"text-center"},[t(r.a,{staticClass:"mr-2",attrs:{color:"#24b224",disabled:!e.isFormValid},on:{click:function(t){e.showModalResult=!0}}},[e._v("\n                        บันทึก\n                    ")]),e._v(" "),t(r.a,{attrs:{color:"#e50211"},on:{click:e.goToStocksManagement}},[e._v("\n                        ย้อนกลับ\n                    ")])],1)],2)],1)],1)],1)}),[],!1,null,"668ac085",null);t.default=component.exports;installComponents(component,{ModalComplete:n(670).default,ModalError:n(677).default,ResultStock:n(749).default})}}]);