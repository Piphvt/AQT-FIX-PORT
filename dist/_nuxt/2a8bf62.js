(window.webpackJsonp=window.webpackJsonp||[]).push([[42,21,23],{670:function(t,e,n){"use strict";n.r(e);var r=n(638),o=n(230),c=n(101),l=n(651),d=n(639),m=n(225),f={props:{method:{type:Function,default:null},open:{required:!0},message:{type:String}},watch:{open:function(t){t?document.addEventListener("keydown",this.handleKeydown):document.removeEventListener("keydown",this.handleKeydown)}},data:function(){return{}},methods:{confirm:function(){null===this.method||this.method(),this.$emit("update:complete",!1)},handleKeydown:function(t){"Escape"===t.key&&this.confirm()}}},h=n(64),component=Object(h.a)(f,(function(){var t=this,e=t._self._c;return e(l.a,{attrs:{persistent:"","retain-focus":!1,"max-width":"300","max-height":"300","content-class":"rounded-xl"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.confirm.apply(null,arguments)}},model:{value:t.open,callback:function(e){t.open=e},expression:"open"}},[e(o.a,[e(c.d,{staticClass:"d-flex align-center justify-center text-h6"},[e(m.a,{staticClass:"mr-3",attrs:{color:"#24b224",size:"40"}},[t._v("mdi-check-circle")]),t._v("\n      สำเร็จ\n    ")],1),t._v(" "),e(d.a,{staticClass:"mb-3"}),t._v(" "),e(c.c,{staticClass:"text-center"},[t._v("\n      "+t._s(t.message)+"\n    ")]),t._v(" "),e(c.a,{staticClass:"justify-center"},[e(r.a,{staticClass:"rounded-xl font-weight-medium mt-0",attrs:{color:"#24b224"},on:{click:t.confirm}},[t._v("\n        ตกลง\n      ")])],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports},677:function(t,e,n){"use strict";n.r(e);var r=n(638),o=n(230),c=n(101),l=n(651),d=n(639),m=n(225),f={props:{method:{type:Function,default:null},open:{required:!0},message:{type:String}},watch:{open:function(t){t?document.addEventListener("keydown",this.handleKeydown):document.removeEventListener("keydown",this.handleKeydown)}},data:function(){return{}},methods:{confirm:function(){null===this.method||this.method(),this.$emit("update:error",!1)},handleKeydown:function(t){"Escape"===t.key&&this.confirm()}}},h=n(64),component=Object(h.a)(f,(function(){var t=this,e=t._self._c;return e(l.a,{attrs:{persistent:"","retain-focus":!1,"max-width":"300","max-height":"300","content-class":"rounded-xl"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.confirm.apply(null,arguments)}},model:{value:t.open,callback:function(e){t.open=e},expression:"open"}},[e(o.a,[e(c.d,{staticClass:"d-flex align-center justify-center text-h6"},[e(m.a,{staticClass:"mr-3",attrs:{size:"40",color:"#e50211"}},[t._v("mdi-alert")]),t._v("\n      เกิดข้อผิดพลาด\n    ")],1),t._v(" "),e(d.a,{staticClass:"mb-3"}),t._v(" "),e(c.c,{staticClass:"text-center"},[t._v("\n      "+t._s(t.message)+"\n    ")]),t._v(" "),e(c.a,{staticClass:"justify-center"},[e(r.a,{staticClass:"rounded-xl font-weight-medium mt-0",attrs:{color:"#24b224"},on:{click:t.confirm}},[t._v("\n        ตกลง\n      ")])],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports},749:function(t,e,n){"use strict";n.r(e);var r=n(638),o=n(230),c=n(101),l=n(921),d=n(651),m=n(225),f=n(4);n(16),n(14),n(92),n(80),n(38),n(19),n(20),n(12),n(6),n(15);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(f.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _={props:{open:Boolean,stocks:Array,sets:Array},data:function(){return{headers:[{text:"ชื่อหุ้น",value:"name"},{text:"ประเภท",value:"set_name"},{text:"จำนวนปันผล",value:"dividend_amount"},{text:"ราคาปิด",value:"closing_price"}]}},computed:{formattedStocks:function(){var t=this.sets||[];return this.stocks.map((function(e){var n=t.find((function(s){return s.id===e.set_id}));return v(v({},e),{},{set_name:n?n.name:""})}))}},methods:{confirm:function(){this.$emit("confirm")},cancel:function(){this.$emit("cancel")}}},k=n(64),component=Object(k.a)(_,(function(){var t=this,e=t._self._c;return e(d.a,{attrs:{"max-width":"500px"},model:{value:t.open,callback:function(e){t.open=e},expression:"open"}},[e(o.a,[e(c.d,{staticClass:"d-flex justify-center"},[e(m.a,{staticClass:"mr-3",attrs:{justify:"center",size:"40",color:"#24b224"}},[t._v("mdi-archive-check")]),t._v(" "),e("span",{staticClass:"headline"},[t._v("ตรวจสอบข้อมูลหุ้น")])],1),t._v(" "),e(c.c,[e(l.a,{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.formattedStocks,"hide-default-footer":""},scopedSlots:t._u([{key:"top",fn:function(){},proxy:!0}])})],1),t._v(" "),e(c.a,{staticClass:"d-flex justify-center"},[e(r.a,{staticClass:"mb-4",attrs:{color:"#24b224"},on:{click:t.confirm}},[t._v("ยืนยัน")]),t._v(" "),e(r.a,{staticClass:"ml-2 mb-4",attrs:{color:"#e50211"},on:{click:t.cancel}},[t._v("ยกเลิก")])],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports},782:function(t,e,n){var content=n(864);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(22).default)("02cbb112",content,!0,{sourceMap:!1})},863:function(t,e,n){"use strict";n(782)},864:function(t,e,n){var r=n(21)((function(i){return i[1]}));r.push([t.i,".little-icon[data-v-53990a7d]{font-size:3rem;margin-left:8px;margin-right:8px}.custom-card[data-v-53990a7d]{margin:auto;max-width:800px;width:100%}",""]),r.locals={},t.exports=r},934:function(t,e,n){"use strict";n.r(e);var r=n(638),o=n(230),c=n(101),l=n(682),d=n(696),m=n(225),f=n(681),h=n(704),v=n(703),_=(n(38),n(31),n(2)),k=(n(14),n(92),n(16),n(74),n(75),n(65),n(94),n(80),n(192),n(61),n(6),n(43),n(47),n(60),n(71),n(34),n(1)),w=n.n(k);function y(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,a){if(t){if("string"==typeof t)return x(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?x(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,c=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw c}}}}function x(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,n=Array(a);e<a;e++)n[e]=t[e];return n}w.a.locale("th");var C={layout:"user",middleware:"auth",mounted:function(){var t=this;return Object(_.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.checkRank();case 2:return e.next=4,t.fetchSetsData();case 4:case"end":return e.stop()}}),e)})))()},data:function(){return{modal:{complete:{open:!1,message:""},error:{open:!1,message:""}},valid:!1,showModalResult:!1,withdrawalItems:[{name:"",set_id:null,dividend_amount:null,closing_price:null}],sets:[]}},computed:{isFormValid:function(){var t=this;return this.withdrawalItems.every((function(e){return t.isNicknameValid(e.name)}))}},methods:{isFloatValid:function(t){return!!t&&/^[0-9]*\.?[0-9]+$/.test(t)},isNicknameValid:function(t){return null!==t&&""!==t},isFromValid:function(t){return null!==t&&""!==t},checkRank:function(){var t=this;return Object(_.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$auth.loggedIn){e.next=12;break}if(n=t.$auth.user.status.toString(),r=t.$auth.user.ranks_id.toString(),"2"!==n){e.next=9;break}return t.$router.push("/"),e.next=7,t.$auth.logout();case 7:e.next=10;break;case 9:"1"===r?t.$router.push("/app/stock/new_stock"):"2"===r?t.$router.push("/app/home"):"3"===r?t.$router.push("/app/stock/new_stock"):t.$router.push("/auth");case 10:e.next=13;break;case 12:t.$router.push("/");case 13:case"end":return e.stop()}}),e)})))()},openModal:function(){this.showModalResult=!0},confirmAndAddCustomers:function(){var t=this;return Object(_.a)(regeneratorRuntime.mark((function e(){var n,r,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=t.findDuplicateIds(t.withdrawalItems)).length>0)){e.next=5;break}return t.modal.error.message="มีหุ้นซ้ำ : ".concat(n.join(", ")),t.modal.error.open=!0,e.abrupt("return");case 5:r=y(t.withdrawalItems),e.prev=6,r.s();case 8:if((o=r.n()).done){e.next=24;break}return c=o.value,e.prev=10,e.next=13,t.$store.dispatch("api/stock/addStock",{name:c.name,set_id:c.set_id,dividend_amount:c.dividend_amount,closing_price:c.closing_price,emp_id:t.$auth.user.no,created_date:w()(new Date).format("YYYY-MM-DD HH:mm:ss"),updated_date:w()(new Date).format("YYYY-MM-DD HH:mm:ss")});case 13:e.next=22;break;case 15:if(e.prev=15,e.t0=e.catch(10),console.error("Error adding stock:",e.t0),!e.t0.response||400!==e.t0.response.status){e.next=22;break}return t.modal.error.message="มีชื่อหุ้นนี้ในระบบแล้ว : ".concat(c.name),t.modal.error.open=!0,e.abrupt("return");case 22:e.next=8;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(6),r.e(e.t1);case 29:return e.prev=29,r.f(),e.finish(29);case 32:t.modal.complete.message="เพิ่มหุ้นเรียบร้อยแล้ว!",t.modal.complete.open=!0,t.recordLog(),t.showModalResult=!1;case 36:case"end":return e.stop()}}),e,null,[[6,26,29,32],[10,15]])})))()},findDuplicateIds:function(t){var e=t.map((function(t){return t.name}));return e.filter((function(t,n){return e.indexOf(t)!==n&&t}))},fetchSetsData:function(){var t=this;return Object(_.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("api/set/getSets");case 3:(n=e.sent)&&(t.sets=n.map((function(t){return{id:t.no,name:t.set}}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching sets:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},addProduct:function(){this.withdrawalItems.push({name:"",set_id:null,dividend_amount:null,closing_price:null})},removeProduct:function(t){this.withdrawalItems.splice(t,1)},goBack:function(){this.$router.push("/app/stock/management")},recordLog:function(){var t=this,details=this.withdrawalItems.map((function(e,n){var r,o=(null===(r=t.sets.find((function(t){return t.id===e.set_id})))||void 0===r?void 0:r.name)||"ยังไม่ระบุ";return"หุ้นที่ ".concat(n+1,"\n")+"ชื่อ : ".concat(e.name||"ยังไม่ระบุ","\n")+"ประเภท : ".concat(o,"\n")+"จำนวนปันผล : ".concat(e.dividend_amount||"ยังไม่ระบุ","\n")+"ราคาปิด : ".concat(e.closing_price||"ยังไม่ระบุ")})).join("\n\n"),e={emp_name:this.$auth.user.fname+" "+this.$auth.user.lname,emp_email:this.$auth.user.email,detail:details.trim(),type:2,picture:this.$auth.user.picture||"ไม่รู้จัก",action:"เพิ่มหุ้นใหม่",time:w()(new Date).format("YYYY-MM-DD HH:mm:ss")};this.$store.dispatch("api/log/addLogs",e)},goToStocksManagement:function(){this.$router.push("/app/stock/management")}}},$=(n(863),n(64)),component=Object($.a)(C,(function(){var t=this,e=t._self._c;return e("div",[e("ModalComplete",{attrs:{open:t.modal.complete.open,message:t.modal.complete.message,complete:t.modal.complete.open,method:t.goBack},on:{"update:complete":function(e){return t.$set(t.modal.complete,"open",e)}}}),t._v(" "),e("ModalError",{attrs:{open:t.modal.error.open,message:t.modal.error.message,error:t.modal.error.open},on:{"update:error":function(e){return t.$set(t.modal.error,"open",e)}}}),t._v(" "),e("ResultStock",{attrs:{open:t.showModalResult,stocks:t.withdrawalItems,sets:t.sets},on:{confirm:t.confirmAndAddCustomers,cancel:function(e){t.showModalResult=!1}}}),t._v(" "),e(o.a,{staticClass:"custom-card",attrs:{flat:""}},[e(c.d,{staticClass:"d-flex align-center justify-center"},[e(m.a,{staticClass:"little-icon",attrs:{color:"#24b224"}},[t._v("mdi-archive-plus")]),t._v("  \n            "),e("h3",{staticClass:"mb-0"},[t._v("หุ้นใหม่")])],1),t._v(" "),e(c.c,[e(d.a,[t._l(t.withdrawalItems,(function(n,o){return e(f.a,{key:o,staticClass:"mb-0 mt-0 pa-0",attrs:{align:"center"}},[e(l.a,{staticClass:"ml-2",attrs:{cols:"3"}},[e(v.a,{attrs:{label:"ชื่อหุ้น",type:"text",dense:"",outlined:"",rules:[function(t){return!!t||"กรุณากรอกชื่อหุ้น"}]},model:{value:n.name,callback:function(e){t.$set(n,"name",e)},expression:"item.name"}})],1),t._v(" "),e(l.a,{attrs:{cols:"2"}},[e(h.a,{attrs:{items:t.sets,"item-text":"name","item-value":"id",label:"ประเภท",dense:"",outlined:""},model:{value:n.set_id,callback:function(e){t.$set(n,"set_id",e)},expression:"item.set_id"}})],1),t._v(" "),e(l.a,{attrs:{cols:"2"}},[e(v.a,{attrs:{label:"จำนวนปันผล",type:"text",dense:"",outlined:"",rules:[function(t){return!t||/^[0-9]*\.?[0-9]+$/.test(t)||"กรุณากรอกตัวเลข"}]},model:{value:n.dividend_amount,callback:function(e){t.$set(n,"dividend_amount",e)},expression:"item.dividend_amount"}})],1),t._v(" "),e(l.a,{attrs:{cols:"2"}},[e(v.a,{attrs:{label:"ราคาปิด",type:"text",dense:"",outlined:"",rules:[function(t){return!t||/^[0-9]*\.?[0-9]+$/.test(t)||"กรุณากรอกตัวเลข"}]},model:{value:n.closing_price,callback:function(e){t.$set(n,"closing_price",e)},expression:"item.closing_price"}})],1),t._v(" "),e(l.a,{staticClass:"d-flex align-center",attrs:{cols:"2"}},[e(r.a,{staticClass:"mb-6",attrs:{icon:"",color:"#e50211"},on:{click:function(e){return t.removeProduct(o)}}},[e(m.a,[t._v("mdi-delete")])],1),t._v(" "),e(r.a,{staticClass:"mb-6 ml-2",attrs:{color:"#24b224",text:""},on:{click:t.addProduct}},[e(m.a,{attrs:{left:""}},[t._v("mdi-archive-plus")]),t._v(" เพิ่ม\n                        ")],1)],1)],1)})),t._v(" "),e("div",{staticClass:"text-center"},[e(r.a,{staticClass:"mr-2",attrs:{color:"#24b224",disabled:!t.isFormValid},on:{click:function(e){t.showModalResult=!0}}},[t._v("\n                        บันทึก\n                    ")]),t._v(" "),e(r.a,{attrs:{color:"#e50211"},on:{click:t.goToStocksManagement}},[t._v("\n                        ย้อนกลับ\n                    ")])],1)],2)],1)],1)],1)}),[],!1,null,"53990a7d",null);e.default=component.exports;installComponents(component,{ModalComplete:n(670).default,ModalError:n(677).default,ResultStock:n(749).default})}}]);